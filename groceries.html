<!DOCTYPE html>
<html>
    <head>
	    <title>Groceries List</title>
	    <link rel="stylesheet" type="text/css" href="style.css">
	    <link rel="stylesheet" type="text/css" href="groceries.css">
    </head>
    <body class="groceries">
        <h1>Grocery List</h1>
        
        <script>
            var cart = []; 
            var Item = function(name, price, count) {
                this.name = name;
                this.price = price;
                this.count = count;
            }; 

            function addItemToCart(name, price, count) {
                for (var i in cart) {
                    if (cart[i].name === name) {
                        cart[i].count += count;
                        return; 
                    }
                 }
                var item  = new Item(name, price, count);
                cart.push(item);
                saveCart();  
            } 

            
            function removeItemFromCart(name) { // Removes one particular item from a cart
                for (var i in cart) {
                    if (cart[i].name === name) {
                        cart[i].count--; //cart[i].count = cart[i].count = cart[i].count -1 (same thing)
                        if (cart[i].count === 0) {
                            cart.splice(i, 1); //can also call removeItemFromCartAll(); here so that you don't duplicate code
                        }
                        break; 
                    }
                }
                saveCart(); 
            }

        
            function removeItemFromCartAll(name) {  // Removes all item name (a particular item)
                for (var i in cart) {
                    if (cart[i].name === name) {
                        cart.splice(i, 1); 
                        break;
                    }
                }
                saveCart(); 
            } 

            function clearCart() {  // clears cart
                cart = [];
                saveCart();  
            } 

            // clearCart(); 
            // console.log(cart);

            
            function countCart() { // return total count
                var totalCount = 0; 
                for (var i in cart) {
                    totalCount += cart[i].count
                }
                return totalCount; 
            }
            
            console.log(countCart());

            
            function totalCart() {  // return total cost
                var totalCost = 0;
                for (var i in cart) {
                    totalCost += cart[i].price;
                }
                return totalCost;
            } 

            console.log(totalCart());

            
            function listCart() {  // returns array of all Items
                var cartCopy = [];
                for (var i in cart) {
                    var item = cart[i]; 
                    var itemCopy = {};
                    for (var p in item) {
                        itemCopy[p] = item[p];
                    }
                    cartCopy.push(itemCopy); 
                } 
                return cartCopy;
                // Can't do return cart; or return cart.slice(); Rememeber arrays and objects are always a reference. 
            } 


            /*var a = ["A", "B", "C"];
            var b = a.slice(); the slice method without any parameters will create a copy of var a (new array 2 seperate arrays). Same concept applies to objects except you can't use slice that applies to arrays.. 
            b.push("D"); 
            console.log(a);
            console.log(b);*/  //This is why we don't do return cart; in listCart(); 

            function saveCart() {  // saves cart to local storage
                localStorage.setItem("shoppingCart", JSON.stringify(cart)); //converts arrays/obj's into a json string
            } 

            
            function loadCart() {  // loads saved cart in local storage
                cart = JSON.parse(localStorage.getItem("shoppingCart"));
            } 

            loadCart();

            var array = listCart(); 
            console.log(array); 

        </script>
    </body>
</html>